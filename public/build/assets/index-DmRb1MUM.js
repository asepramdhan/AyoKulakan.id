import{c as le,u as ie,b as ne,j as e,F as ce,H as oe,d as de,L as Q}from"./app-BqtqdjX3.js";import{S as me}from"./ShoppingListController-BjVYbz0_.js";import{I as T}from"./input-error-DabNGbCD.js";import{A as pe,a as he}from"./alert-DQgWVptN.js";import{a as xe,B as x}from"./app-logo-icon-BIkVnSRQ.js";import{C as Y,a as Z,b as ee,c as te}from"./card-BOmGbNJR.js";import{E as ue,a as ge,b as je,c as fe}from"./empty-pBr-LR4X.js";import{I as C}from"./input-C8Dhusxl.js";import{L as y}from"./label-C7DnN2yd.js";import{S as be,a as Ne,b as ve,d as ye,e as ke,f as we,g as Se}from"./select-BPt2tF9y.js";import{S as _e}from"./spinner-B5wCgLCR.js";import{T as W,a as h,b as Te,c as k,d as Ce,e as De}from"./table-DaxxIfTT.js";import{j as Ie,A as Le,s as w}from"./app-layout-CLP3L5XL.js";import{P as Be}from"./plus-rg9zvR-F.js";import{T as re}from"./trash-2-D6pxsqf-.js";import{S as qe}from"./save-D5GCP-te.js";import{C as X}from"./circle-check-DjgUL42g.js";import{P as ze}from"./pencil-CROYEKGk.js";import{z as se}from"./transition-BTGNhatT.js";/* empty css            */import"./index-C4J_hXM0.js";import"./index-DKvHeNch.js";import"./index-BiLsJ8o_.js";import"./index-CkARvzOx.js";import"./check-BJVU700Q.js";import"./loader-circle-DLs1_K7J.js";const Re=[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]],$e=xe("CloudDownload",Re),Fe=[{title:"Daftar Belanja",href:w.index().url}],ae=s=>s==null||s===""?"":Math.floor(Number(s)).toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),Ee=s=>{if(typeof s=="number")return s;const t=s.replace(/\D/g,"");return t?parseInt(t,10):0},Pe=s=>{const t=new Date(s),d=t.toLocaleDateString("id-ID",{weekday:"long"}),u=t.toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"2-digit"}).replace(/\//g,"-"),o=t.toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}).replace(".",":");return`${d}, ${u} ${o}`};function bt(s){const t=le.c(45),{stores:d,shoppingLists:u,products:o}=s,{flash:m}=ie().props,V=d?.[0]?.id||"";let D;t[0]===Symbol.for("react.memo_cache_sentinel")?(D=new Date().toISOString().split("T"),t[0]=D):D=t[0];let I;t[1]===Symbol.for("react.memo_cache_sentinel")?(I=[{product_id:null,product_name:"",quantity:null,price:null}],t[1]=I):I=t[1];let L;t[2]!==V?(L={store_id:V,title:"",shopping_date:D[0],items:I},t[2]=V,t[3]=L):L=t[3];const{data:a,setData:c}=ne(L);let B;t[4]!==a.items||t[5]!==c?(B=()=>{c("items",[...a.items,{product_id:null,product_name:"",quantity:1,price:null}])},t[4]=a.items,t[5]=c,t[6]=B):B=t[6];const G=B;let q;t[7]!==a.items||t[8]!==c?(q=n=>{const l=[...a.items];l.splice(n,1),c("items",l)},t[7]=a.items,t[8]=c,t[9]=q):q=t[9];const K=q;let z;t[10]!==a.items||t[11]!==o||t[12]!==c?(z=(n,l,v)=>{const r=[...a.items];if(l==="price"?r[n][l]=Ee(v):l==="quantity"?r[n][l]=parseInt(v)||0:r[n][l]=v,l==="product_name"){const p=o.find(i=>i.name.toLowerCase()===v.toLowerCase());p?(r[n].price=p.last_price||0,r[n].product_id=p.id):r[n].product_id=null}c("items",r)},t[10]=a.items,t[11]=o,t[12]=c,t[13]=z):z=t[13];const S=z;let R;t[14]!==a.items?(R=a.items.reduce(Ve,0),t[14]=a.items,t[15]=R):R=t[15];const $=R;let F;t[16]===Symbol.for("react.memo_cache_sentinel")?(F=e.jsx(oe,{title:"Daftar Belanja"}),t[16]=F):F=t[16];let E;t[17]===Symbol.for("react.memo_cache_sentinel")?(E=e.jsx(ee,{children:e.jsx(te,{children:"Buat Daftar Belanja Baru"})}),t[17]=E):E=t[17];let P,A;t[18]===Symbol.for("react.memo_cache_sentinel")?(P=me.store(),A={preserveScroll:!0},t[18]=P,t[19]=A):(P=t[18],A=t[19]);let g;t[20]!==G||t[21]!==a.items||t[22]!==m.message||t[23]!==o||t[24]!==K||t[25]!==d||t[26]!==$||t[27]!==S?(g=e.jsxs(Y,{children:[E,e.jsx(Z,{children:e.jsx(ce,{...P,options:A,className:"space-y-6",children:n=>{const{processing:l,recentlySuccessful:v,errors:r}=n;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"store",children:"Pilih Toko"}),e.jsxs(be,{name:"store_id",required:!0,children:[e.jsx(Ne,{className:"w-full",children:e.jsx(ve,{placeholder:"Pilih Toko"})}),e.jsx(ye,{children:e.jsxs(ke,{children:[e.jsx(we,{children:"Daftar Toko Kamu"}),d.map(Qe)]})})]}),e.jsx(T,{message:r.store_id})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"title",children:"Judul Belanja"}),e.jsx(C,{id:"title",name:"title",className:"mt-1 block w-full",placeholder:"Contoh: pakan kucing",required:!0}),e.jsx(T,{message:r.title})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"tanggal",children:"Tanggal"}),e.jsx(C,{id:"tanggal",type:"datetime-local",name:"shopping_date",defaultValue:Je(),className:"mt-1 block w-full",required:!0}),e.jsx(T,{message:r.shopping_date})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[e.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-slate-50",children:"Daftar Barang"}),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:G,className:"cursor-pointer border-green-600 text-green-600 hover:bg-green-50 dark:hover:bg-green-800",children:[e.jsx(Be,{className:"w-4 h-4"}),"Tambah"]})]}),e.jsxs("div",{className:"space-y-6 md:space-y-2",children:[" ",a.items.map((p,i)=>e.jsxs("div",{className:"relative transition-all",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-start md:items-center",children:[" ",e.jsxs("div",{className:"md:col-span-6",children:[e.jsx(y,{className:"text-[10px] uppercase font-bold text-slate-500 dark:text-slate-400 md:hidden",children:"Nama Barang"}),e.jsx(C,{list:"product-suggestions",className:"mt-1 bg-white md:mt-0 dark:bg-slate-800",name:`items.${i}.product_name`,value:p.product_name,onChange:_=>S(i,"product_name",_.target.value),placeholder:"Nama barang...",required:!0,autoComplete:"off"})]}),e.jsxs("div",{className:"md:col-span-6 grid grid-cols-12 gap-3 items-center",children:[e.jsxs("div",{className:"col-span-4 md:col-span-3",children:[e.jsx(y,{className:"text-[10px] uppercase font-bold text-slate-500 dark:text-slate-400 md:hidden",children:"Qty"}),e.jsx(C,{type:"number",className:"mt-1 bg-white md:mt-0 dark:bg-slate-800 text-center",name:`items.${i}.quantity`,value:p.quantity,onChange:_=>S(i,"quantity",parseInt(_.target.value)),placeholder:"Qty",required:!0})]}),e.jsxs("div",{className:"col-span-8 md:col-span-7",children:[e.jsx(y,{className:"text-[10px] uppercase font-bold text-slate-500 dark:text-slate-400 md:hidden",children:"Harga"}),e.jsxs("div",{className:"relative mt-1 md:mt-0",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs dark:text-slate-300",children:"Rp"}),e.jsx(C,{type:"text",className:"pl-8 bg-white font-medium dark:bg-slate-800",name:`items.${i}.price`,value:ae(p.price),onChange:_=>S(i,"price",_.target.value),placeholder:"100.000",required:!0})]})]}),e.jsx("div",{className:"absolute -top-3 -right-3 md:relative md:top-0 md:right-0 md:col-span-2 flex justify-end",children:a.items.length>1&&e.jsx(x,{type:"button",variant:"ghost",size:"icon",onClick:()=>K(i),className:"h-8 w-8 rounded-full bg-red-100 text-red-600 md:bg-transparent md:text-slate-400 md:hover:text-red-600 md:hover:bg-red-50 cursor-pointer transition-colors dark:hover:bg-red-800 dark:hover:text-red-400",children:e.jsx(re,{className:"w-4 h-4"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[e.jsx("div",{className:"md:col-span-6",children:e.jsx(T,{message:r[`items.${i}.product_name`]})}),e.jsx("div",{className:"md:col-span-6",children:e.jsx(T,{message:r[`items.${i}.price`]})})]})]},i))]}),e.jsx("datalist",{id:"product-suggestions",children:o.map(Oe)})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[e.jsxs("div",{className:"text-xl font-bold tracking-tight text-green-600",children:["Total: Rp ",$?ae($):"-"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(se,{show:v,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:m.message||"Tersimpan"})}),e.jsx(x,{type:"submit",disabled:l,className:"bg-green-600 hover:bg-green-700 cursor-pointer",children:l?e.jsxs(e.Fragment,{children:[e.jsx(_e,{className:"h-4 w-4 animate-spin"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{className:"w-4 h-4"}),"Simpan"]})})]})]})]})}})})]}),t[20]=G,t[21]=a.items,t[22]=m.message,t[23]=o,t[24]=K,t[25]=d,t[26]=$,t[27]=S,t[28]=g):g=t[28];let H;t[29]===Symbol.for("react.memo_cache_sentinel")?(H=e.jsx(X,{}),t[29]=H):H=t[29];const U=m.delete||"Terhapus";let j;t[30]!==U?(j=e.jsxs(pe,{className:"mb-2 text-green-600 bg-green-50 dark:bg-green-800 dark:text-green-200",children:[H,e.jsx(he,{children:U})]}),t[30]=U,t[31]=j):j=t[31];let f;t[32]!==m.delete||t[33]!==j?(f=e.jsx(se,{show:m.delete,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:j}),t[32]=m.delete,t[33]=j,t[34]=f):f=t[34];let M;t[35]===Symbol.for("react.memo_cache_sentinel")?(M=e.jsx(ee,{children:e.jsx(te,{children:"Riwayat Belanja Terakhir"})}),t[35]=M):M=t[35];let O;t[36]===Symbol.for("react.memo_cache_sentinel")?(O=e.jsx(Te,{children:e.jsxs(W,{children:[e.jsx(k,{children:"Tanggal"}),e.jsx(k,{children:"Toko"}),e.jsx(k,{children:"Judul"}),e.jsx(k,{children:"Total Estimasi"}),e.jsx(k,{children:"Status"}),e.jsx(k,{className:"text-right",children:"Aksi"})]})}),t[36]=O):O=t[36];let b;t[37]!==u?(b=u.length>0?u.map(Ae):e.jsx(W,{children:e.jsx(h,{colSpan:6,className:"text-center py-10 text-muted-foreground",children:e.jsx(ue,{children:e.jsxs(ge,{children:[e.jsx(je,{variant:"icon",children:e.jsx(Ie,{className:"w-8 h-8 text-slate-400"})}),e.jsx(fe,{className:"text-slate-400",children:"Belum ada data belanja."})]})})})}),t[37]=u,t[38]=b):b=t[38];let N;t[39]!==b?(N=e.jsxs(Y,{children:[M,e.jsx(Z,{children:e.jsxs(Ce,{children:[O,e.jsx(De,{children:b})]})})]}),t[39]=b,t[40]=N):N=t[40];let J;return t[41]!==g||t[42]!==f||t[43]!==N?(J=e.jsxs(Le,{breadcrumbs:Fe,children:[F,e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[g,f,N]})]}),t[41]=g,t[42]=f,t[43]=N,t[44]=J):J=t[44],J}function Ae(s){return e.jsxs(W,{className:"cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",onClick:()=>de.visit(w.check(s.id).url),children:[e.jsx(h,{children:Pe(s.shopping_date)}),e.jsx(h,{children:e.jsx("span",{className:"px-2 py-1 rounded-full bg-blue-100 text-blue-700 dark:bg-blue-700 dark:text-blue-100 text-xs font-medium capitalize",children:s.store.name})}),e.jsx(h,{className:"font-medium capitalize",children:s.title}),e.jsx(h,{className:"whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[e.jsxs("span",{className:"text-green-600",title:"Sudah dibeli",children:["Rp ",Number(s.total_bought_price||0).toLocaleString("id-ID")]}),e.jsx("span",{className:"text-slate-400 mx-1",children:"/"}),e.jsx("span",{className:"text-slate-500",title:"Total estimasi",children:Number(s.total_estimated_price).toLocaleString("id-ID")})]}),s.status!=="completed"?e.jsxs("span",{className:"text-[10px] text-amber-600 font-medium",children:["Sisa: Rp ",Number(s.total_estimated_price-(s.total_bought_price||0)).toLocaleString("id-ID")," lagi"]}):e.jsxs("span",{className:"text-[10px] text-green-600 font-medium flex items-center gap-1",children:[e.jsx(X,{className:"w-2.5 h-2.5"})," Lunas / Selesai"]})]})}),e.jsx(h,{children:e.jsxs("div",{className:"min-w-[120px]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:`text-[10px] font-bold ${s.status==="completed"?"text-green-600":"text-amber-600"}`,children:s.status==="completed"?"100%":"Sedang Berjalan"}),e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:[s.completed_items_count||0,"/",s.items_count||0]})]}),e.jsx("div",{className:"w-full bg-slate-100 dark:bg-slate-800 h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${s.status==="completed"?"bg-green-500":"bg-amber-500"}`,style:{width:`${s.completed_items_count/s.items_count*100}%`}})})]})}),e.jsxs(h,{className:"text-right space-x-2",onClick:Me,children:[e.jsx(Q,{href:w.check(s.id),children:e.jsx(x,{variant:"default",size:"sm",className:"bg-orange-500 hover:bg-orange-600 cursor-pointer",children:e.jsx(X,{className:"w-4 h-4"})})}),e.jsx(Q,{href:w.edit(s.id),children:e.jsx(x,{variant:"default",size:"sm",className:"bg-sky-500 hover:bg-sky-600 cursor-pointer",children:e.jsx(ze,{className:"w-4 h-4"})})}),e.jsx(Q,{href:w.export(s.id),children:e.jsx(x,{variant:"outline",size:"sm",className:"hover:text-sky-600 cursor-pointer",children:e.jsx($e,{className:"w-4 h-4"})})}),e.jsx(Q,{href:w.destroy(s.id),className:"cursor-pointer",onClick:He,children:e.jsx(x,{variant:"ghost",size:"sm",className:"hover:text-rose-600 cursor-pointer",children:e.jsx(re,{className:"w-4 h-4"})})})]})]},s.id)}function He(s){confirm("Anda yakin ingin menghapus riwayat belanja ini?")||s.preventDefault()}function Me(s){return s.stopPropagation()}function Oe(s){return e.jsx("option",{value:s.name},s.id)}function Je(){const s=new Date,t=s.getTimezoneOffset()*6e4;return new Date(s.getTime()-t).toISOString().slice(0,16)}function Qe(s){return e.jsx(Se,{value:s.id.toString(),children:e.jsx("span",{className:"capitalize",children:s.name})},s.id)}function Ve(s,t){return s+t.quantity*t.price}export{bt as default};
