import{r as n,j as e,H as J,a as U}from"./app-DUSVlt4_.js";import{B as k}from"./badge-DOAonW2c.js";import{C as g,a as u,b as G,c as O}from"./card-fV1JMGfy.js";import{T as Q,a as W,b as v,c as l,d as X,e as r}from"./table-Z2-Nm_3X.js";import{I as p}from"./input-Rg6CjgWR.js";import{L as b}from"./label-B2SiUJ-G.js";import{A as Y,a as Z}from"./app-layout-D6iWFSfB.js";import{c as w,B as o}from"./app-logo-icon-DL6uu5NJ.js";import{T as A}from"./trending-up-C9dpQplb.js";/* empty css            */import"./index-B82T-xMB.js";import"./index-Ba9IFggz.js";import"./index-C4J_hXM0.js";const ee=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ae=w("ArrowRight",ee);const se=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],y=w("ChartColumn",se);const te=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],re=w("TrendingDown",te),le=[{title:"Analisa Margin",href:"/analysis/margin"}];function Ne({analysisData:P}){const[c,R]=n.useState(6),[d,L]=n.useState(1250),[m,S]=n.useState(0),[x,H]=n.useState(0),[t,j]=n.useState("all"),B=20,{summary:_,filteredData:C}=n.useMemo(()=>{let a=0,T=0;const M=P.map(s=>{const i=Number(s.sell_price||0),h=Number(s.buy_price??s.last_price??0),f=Number(s.stock??s.qty??0),E=i*c/100,V=i*m/100,K=i*x/100,D=E+V+K+d,N=i-h-D;f>0&&(T+=h*f,a+=N*f);const $=i>0?N/i*100:0,I=1-(c+m+x+B)/100,q=I>0?(h+d)/I:0;return{...s,buy_price_final:h,admin_fee_amount:D,net_profit:N,margin_percent:Math.round($*100)/100,recommended_price:Math.ceil(q/100)*100}}),z=M.filter(s=>t==="all"?!0:t==="kritis"?s.margin_percent<=5:t==="tipis"?s.margin_percent>5&&s.margin_percent<=15:t==="sehat"?s.margin_percent>15:!0);return{calculatedData:M,summary:{totalPotentialProfit:a,totalInventoryValue:T},filteredData:z}},[c,m,x,d,P,t]),F=a=>a<=5?e.jsxs(k,{variant:"destructive",children:["Kritis (",a,"%)"]}):a<=15?e.jsxs(k,{className:"bg-orange-500 text-white border-none",children:["Tipis (",a,"%)"]}):e.jsxs(k,{className:"bg-green-600 text-white border-none",children:["Sehat (",a,"%)"]});return e.jsxs(Y,{breadcrumbs:le,children:[e.jsx(J,{title:"Simulator Analisa Margin"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[e.jsx(g,{className:"border-none bg-gradient-to-br from-slate-50 to-blue-50 shadow-sm dark:from-slate-900/50 dark:to-blue-950/20",children:e.jsxs(u,{className:"p-6",children:[e.jsxs("h3",{className:"mb-4 text-lg font-bold text-blue-900 dark:text-blue-300 flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"})," Kalkulator Biaya Admin"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(b,{className:"text-xs font-semibold",children:"Admin Dasar (%)"}),e.jsx(p,{type:"number",value:c,onChange:a=>R(Number(a.target.value)),className:"bg-white dark:bg-slate-950"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(b,{className:"text-xs font-semibold text-orange-600",children:"Program Extra (%)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{type:"number",value:m,onChange:a=>S(Number(a.target.value)),className:"bg-white dark:bg-slate-950"}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>S(9),children:"9%"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(b,{className:"text-xs font-semibold",children:"Fix Fee / Pesanan (Rp)"}),e.jsx(p,{type:"number",value:d,onChange:a=>L(Number(a.target.value)),className:"bg-white dark:bg-slate-950"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(b,{className:"text-xs font-semibold text-blue-600",children:"Iklan / Affiliate (%)"}),e.jsx(p,{type:"number",value:x,onChange:a=>H(Number(a.target.value)),className:"bg-white dark:bg-slate-950"})]})]}),e.jsxs("p",{className:"mt-4 text-[10px] text-slate-500 italic",children:["*Rumus: Harga Jual - Modal - (Admin + Extra + Iklan)% - Fix Fee ",d.toLocaleString()," = Profit Bersih."]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(g,{className:"bg-white dark:bg-slate-900 border-l-4 border-l-slate-400",children:e.jsxs(u,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500 uppercase tracking-wider",children:"Total Modal Mengendap"}),e.jsxs("h3",{className:"text-2xl font-bold text-slate-700 dark:text-slate-200",children:["Rp ",_.totalInventoryValue.toLocaleString("id-ID")]})]}),e.jsx("div",{className:"p-3 bg-slate-100 dark:bg-slate-800 rounded-full",children:e.jsx(y,{className:"w-6 h-6 text-slate-500"})})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-2 italic",children:"*Total harga beli x stok saat ini"})]})}),e.jsx(g,{className:"bg-white dark:bg-slate-900 border-l-4 border-l-green-500 shadow-md",children:e.jsxs(u,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600 uppercase tracking-wider",children:"Estimasi Profit Bersih"}),e.jsxs("h3",{className:"text-2xl font-bold text-green-700 dark:text-green-400",children:["Rp ",_.totalPotentialProfit.toLocaleString("id-ID")]})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-full",children:e.jsx(A,{className:"w-6 h-6 text-green-600"})})]}),e.jsx("p",{className:"text-[10px] text-green-500 mt-2 italic",children:"*Profit bersih (setelah biaya admin) jika semua stok laku"})]})})]}),e.jsxs(g,{children:[e.jsxs(G,{className:"flex flex-row items-center justify-between",children:[e.jsxs(O,{className:"text-xl flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"})," Hasil Simulasi Profit"]}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 dark:bg-slate-800 p-1 rounded-lg",children:[e.jsx(o,{variant:t==="all"?"default":"ghost",size:"sm",onClick:()=>j("all"),className:"text-xs h-8",children:"Semua"}),e.jsx(o,{variant:t==="kritis"?"destructive":"ghost",size:"sm",onClick:()=>j("kritis"),className:"text-xs h-8",children:"Kritis (â‰¤5%)"}),e.jsx(o,{variant:t==="tipis"?"secondary":"ghost",size:"sm",onClick:()=>j("tipis"),className:"text-xs h-8 bg-orange-500 text-white hover:bg-orange-600",children:"Tipis"})]})]}),e.jsx(u,{children:e.jsxs(Q,{children:[e.jsx(W,{className:"bg-slate-50 dark:bg-slate-900",children:e.jsxs(v,{children:[e.jsx(l,{children:"Produk"}),e.jsx(l,{children:"Harga Modal"}),e.jsx(l,{children:"Harga Jual"}),e.jsxs(l,{children:["Potongan (",c,"%)"]}),e.jsx(l,{children:"Profit Bersih"}),e.jsx(l,{children:"Kesehatan"}),e.jsx(l,{className:"bg-green-50 dark:bg-green-950/30",children:"Saran Harga (Margin 20%)"})]})}),e.jsx(X,{children:C.length>0?C.map(a=>e.jsxs(v,{children:[e.jsx(r,{className:"font-medium capitalize",children:a.name}),e.jsxs(r,{children:["Rp ",a.buy_price.toLocaleString("id-ID")]}),e.jsxs(r,{children:["Rp ",a.sell_price.toLocaleString("id-ID")]}),e.jsxs(r,{className:"text-red-500 text-xs italic",children:["- Rp ",a.admin_fee_amount.toLocaleString("id-ID")]}),e.jsx(r,{className:`font-bold ${a.net_profit<=0?"text-red-500":"text-green-600"}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[a.net_profit>0?e.jsx(A,{className:"w-3 h-3"}):e.jsx(re,{className:"w-3 h-3"}),"Rp ",a.net_profit.toLocaleString("id-ID")]})}),e.jsx(r,{children:F(a.margin_percent)}),e.jsx(r,{className:"bg-green-50/50 dark:bg-green-950/10 font-bold",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-blue-600",children:["Rp ",a.recommended_price.toLocaleString("id-ID")]}),e.jsx("span",{className:"text-[10px] text-slate-400 font-normal",children:"Target untung 20%"})]}),e.jsxs(o,{type:"submit",variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:()=>{confirm(`Terapkan harga baru Rp ${a.recommended_price.toLocaleString("id-ID")}?`)&&U.patch(Z.margin.updatePrice(a.id),{sell_price:a.recommended_price},{preserveScroll:!0,onSuccess:()=>alert("Harga berhasil diperbarui!")})},children:["Terapkan ",e.jsx(ae,{className:"w-3 h-3"})]})]})})]},a.id)):e.jsx(v,{children:e.jsx(r,{colSpan:7,className:"text-center py-10 text-slate-400",children:"Tidak ada produk dengan kategori ini."})})})]})})]})]})]})}export{Ne as default};
